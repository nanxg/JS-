<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>文本查找替换</title>
    <style>
        * {
            margin: 0px;
            padding: 0px;
        }

        section {
            width: 800px;
            height: 630px;
            margin: 50px auto;
            padding-top: 40px;
            background-color: rgb(171, 221, 231);
            background: url("images/background.png") no-repeat;
            overflow: hidden;
        }

        #logo {
            width: 200px;
            height: 48px;
            margin: 0px auto;
        }

        #top {
            width: 520px;
            height: 274px;
            border-radius: 10px;
            margin: 20px auto;
            background-color: white;
            padding: 27px;
            box-shadow: 0px 0 7px RGB(152, 210, 221);
            z-index: 99;
        }

        #top .top_container {
            width: 360px;
            height: 230px;
            padding: 20px;
            float: left;
            overflow: hidden;
        }

        .bg {
            background-color: rgb(238, 248, 250);
            border: 1px solid rgb(171, 221, 231);
            border-radius: 2px;
            color: #004654;
            font-family: 'Lantinghei SC ';
        }

        #top .top_container p {
            line-height: 30px;
            font-size: 14px;
            height: 30px;
            color: #004654;
            width: 360px;
            height: 240px;
            border-width: 0;
            background-color: rgba(0, 0, 0, 0);
            overflow: auto;
        }

        #top .top_container p span {
            line-height: 30px;
            background-color: green;
            color: white;
            height: 30px;
            display: inline-block;

        }

        #top .top_func {
            float: left;

            width: 100px;
            height: 270px;
            margin-left: 17px;
        }

        #top .top_func ul {
            width: 100%;
            height: 100%;
            position: relative;
        }

        #top .top_func ul li {
            width: 100px;
            height: 65px;
            list-style: none;
            border-radius: 3px;
            position: absolute;
            padding-top: 15px;
            cursor: pointer;
            transition: .5s;

        }

        #top .top_func ul li img {
            display: block;
            margin: 0px auto;
            width: 27px;
            height: 27px;
            padding-top: 0px;
            transition: .5s;
            _transform: rotate(45deg);
        }

        #top .top_func ul li p {
            font-size: 16px;
            font-family: 'Lantinghei SC ';
            color: white;
            display: block;
            height: 40px;
            width: 100px;
            text-align: center;
            line-height: 40px;
        }

        #top .top_func ul .func_open {
            background-color: rgb(144, 226, 242);
        }

        #top .top_func ul .func_find {
            _background-color: rgb(168, 166, 245);
            _display: none;
            _top: 95px;
            top: 0;
            background-color: rgb(159, 231, 169);
        }
        #top .top_func ul .func_replace {
            background-color: rgb(159, 231, 169);
            _display: none;
            /* top:190px; */
            top: 0;
        }
        #bottom {

            width: 526px;
            height: 158px;
            position: relative;
            top: 12px;
            margin: 0 auto;
            border-radius: 10px;
            background-color: white;
            color: white;
            padding: 0px 22px;
            box-shadow: 0px 0 7px rgb(147, 208, 221);
            display: none;
        }

        #bottom div {
            height: 40px;
            padding-top: 25px;
        }

        #bottom div a {
            display: block;
            font-size: 16px;
            width: 100px;
            height: 40px;
            border-radius: 3px;
            float: left;
            line-height: 40px;
            text-align: center;
            cursor: pointer;
        }

        #bottom div .find {
            _background-color: rgb(168, 166, 245);
            margin-left: 5px;
            background-color: rgb(159, 231, 169);
        }

        #bottom div .replace {
            background-color: rgb(159, 231, 169);
            margin-left: 20px;
        }

        #bottom div .close {
            color: #222222;
            width: 14px;
            height: 14px;
            float: right;
            background: url("images/close.png");
        }

        #bottom input {
            float: left;
        }

        #bottom #text1 {
            margin: 14px 0 0 5px;
            width: 400px;
            height: 48px;
            padding-left: 10px;
            font-size: 16px;
            /*display: none;*/
        }

        #text2 {
            margin: 14px 0 0 5px;
            width: 190px;
            height: 48px;
            padding-left: 10px;
            font-size: 16px;
            display: none;
        }

        #text3 {
            margin: 14px 0 0 8px;
            width: 190px;
            height: 48px;
            padding-left: 10px;
            font-size: 16px;
            display: none;
        }

        #bottom #btn1 {
            width: 60px;
            height: 40px;
            background-color: rgb(168, 166, 245);
            margin: 14px 0 0 10px;
            float: right;
            border-radius: 2px;
            padding: 10px 0 0 36px;
            cursor: pointer;
        }

        #prompt {
            height: 30px;
            margin-top: 10px;
            color: red;
            font-size: 12px;
            text-align: center;
            line-height: 30px;
        }
    </style>
</head>

<body>
    <section>
        <div id="container">
            <div id="logo">
            </div>
            <div id="top">
                <div class="top_container bg">
                    <p id="pp">
                        教育理念：
                        认识到每个人的优势和价值，进行不同的指导和引导、推荐到更适合的平台。我们不仅仅是努力，不仅仅是传授技术，更重要的是：我们是发现你的伯乐！
                        传奇就业：
                        超过50%的学员工资翻倍或进入百度、新浪、腾讯等知名公司！

                        强悍课程：
                        原生javaScript、算法及编程思想、设计模式、Ajax后台技术,HTML5+CSS3移动端客户端开发，Node.js、jQuery、Vue、React框架讲解
                    </p>
                </div>
                <div class="top_func">
                    <ul>
                        <li class="func_replace a">
                            <img src="images/images/replace_11.png">
                            <p>替换</p>
                        </li>
                        <li class="func_find a">
                            <img src="images/images/li_bg_12.png">
                            <p>查找</p>
                        </li>
                        <li class="func_open">
                            <img id="img1" src="images/images/open_10.png">

                            <p class="p1">展开</p>
                            <!-- <p class="a">收缩</p> -->
                        </li>
                    </ul>
                </div>
            </div>
            <div id="bottom">
                <div>
                    <a class="find">查找</a>
                    <a class="replace">替换</a>
                    <a class="close"></a>
                </div>
                <input id="text1" class="bg" type="text" placeholder="输入要查找的内容">
                <input id="text2" class="bg" type="text" placeholder="输入要查找的内容">
                <input id="text3" class="bg" type="text" placeholder="输入要替换的内容">
                <div id="btn1">
                    <img src="images/images/li_bg_12.png">
                </div>
                <div id="prompt"></div>
            </div>
        </div>
        <span></span>
    </section>
    <!-- 一版 -->
    <!-- <script>
        let lis=document.querySelectorAll('.top_func li')
        let ps=document.querySelectorAll('.top_func p')
        let aa=document.querySelectorAll('#bottom a')
        let img2=document.querySelector('#btn1 img')
        let ppp=pp.innerText
        lis[2].onclick=function(){
            lis[0].classList.toggle('a')
            lis[1].classList.toggle('a')
            ps[2].classList.toggle('a')
            ps[3].classList.toggle('a')
            img1.classList.toggle('b')
        }
        lis[0].onclick = function(){
            bottom.style.display=text2.style.display= text3.style.display='block'
            this.style.backgroundColor=aa[1].style.backgroundColor='rgb(168, 166, 245)'
            lis[1].style.backgroundColor=aa[0].style.backgroundColor='rgb(159, 231, 169)'
            text1.style.display='none'
            img2.attributes.src.value='images/images/replace_11.png'; 
        }
        lis[1].onclick = function(){
            bottom.style.display=text1.style.display='block'
            this.style.backgroundColor=aa[0].style.backgroundColor='rgb(168, 166, 245)'
            lis[0].style.backgroundColor=aa[1].style.backgroundColor='rgb(159, 231, 169)'
            text2.style.display=text3.style.display='none'
            img2.attributes.src.value='images/images/li_bg_12.png';
        }
        aa[2].onclick=function(){
            bottom.style.display='none';
            pp.innerText=ppp
        }
        btn1.onclick=function(){
            if(text1.style.display=='block'){
                var te1=text1.value; 
                if(te1){
                    pp.innerHTML=(ppp.split(te1)).join('<span>'+ te1 +'</span>')
                }else{
                    alert('不写内容找啥子！！！')
                }    
            }else{
                var te2=text2.value;
                var te3=text3.value;
                if(te2&&te3){
                    //pp.innerHTML=(pp.innerHTML.split(te2)).join('<span>'+ te3 +'</span>')
                    pp.innerHTML=(ppp.split(te2)).join('<span>'+ te3 +'</span>')
                    ppp=(ppp.split(te2)).join( te3 )
                }else{
                    alert('不写内容找啥子！！！')
                }    
            }
            text1.value=text2.value=text3.value=''
        }
    </script> -->
<!-- 搞对象 -->
<script>
    class FindReplace {
        constructor() {
            this.btn = document.querySelectorAll('.top_func li');
            this.p = document.querySelector('.top_container p');
            this.a = document.querySelectorAll('#bottom a');
            this.pp = this.p.innerText;
            this.events()
        }
        events() {
            this.btn.forEach((ele, i) => {
                let _this = this
                ele.onoff = false;
                ele.onclick = function () {
                    switch (i) {
                        // 展开收缩
                        case 2:
                            let nextL = this.previousElementSibling;
                            let lastL = nextL.previousElementSibling;
                            if (this.onoff) {
                                nextL.style.top = lastL.style.top = '0';
                                this.children[0].style.transform = 'rotate(0deg)';//图标旋转
                                this.children[1].innerText = '展开';
                                setTimeout(() => {    //延迟消失
                                    bottom.style.display = 'none';
                                }, 450)
                            } else {
                                nextL.style.top = '95px';
                                lastL.style.top = '195px';
                                this.children[0].style.transform = 'rotate(45deg)';//图标旋转
                                this.children[1].innerText = '收缩';
                            }
                            this.onoff = !this.onoff
                            break
                        //查找    
                        case 1:
                            text1.style.display = bottom.style.display = 'block';
                            text2.style.display = text3.style.display = 'none';
                            this.style.backgroundColor=_this.a[0].style.backgroundColor="rgb(168, 166, 245)";
                            _this.btn[0].style.backgroundColor=_this.a[1].style.backgroundColor="rgb(159, 231, 169)";
                            this.onoff = true;
                            _this.btn[0].onoff = false;
                            break
                        //替换    
                        case 0:
                            bottom.style.display = text2.style.display = text3.style.display = 'block';
                            text1.style.display = 'none';
                            this.style.backgroundColor=_this.a[1].style.backgroundColor="rgb(168, 166, 245)";
                            _this.btn[1].style.backgroundColor=_this.a[0].style.backgroundColor="rgb(159, 231, 169)";
                            this.onoff = true;
                            _this.btn[1].onoff = false;
                            break
                    }
                }
            })
            btn1.onclick =()=>{
                //查找
                if (this.btn[1].onoff) { 
                    let value = text1.value.trim(); //获取text1的输入值并去掉前后空格
                    let re = new RegExp(value);
                    if (!value) {       
                        alert('请输入查找内容');
                        return;
                    }else if (re.test(this.pp)) { //正则验证有没有这个文字
                        this.p.innerHTML = this.pp.split(value).join('<span>' + value + '</span>')
                        text1.value = '';
                    } else {
                        alert('没有!~去隔壁找老王');
                    }
                }
                // 替换
                if (this.btn[0].onoff) { 
                    let { value: v1 } = text2;
                    let { value: v2 } = text3;
                    v1 = v1.trim();
                    v2 = v2.trim();
                    //查找的没有
                    if (!this.pp.includes(v1)) {
                        alert('没有!~去隔壁找老王');
                        return;
                    }
                    if (v1) {  //只输入text2的内容就查找，
                        this.p.innerHTML = this.pp.split(v1).join('<span>' + v1 + '</span>')
                        text2.value = '';
                        if(v2){   //text2与text3都有内容就替换
                            this.p.innerHTML = this.pp.split(v1).join(`<span>${v2}</span>`);
                            //把原始的文本内容替换成最新的；否则替换只是表面替换，还是查找原来的文本
                            this.pp = this.pp.split(v1).join(`${v2}`);
                            text2.value = text3.value = ''; 
                        }  
                    }else{
                        alert('请输入查找替换内容');
                        return;
                    }   
                }
            }
            this.a.forEach((ele,i)=>{
                let _this=this
                ele.onclick=function(){
                    switch(this.className){
                        case 'find':
                        text1.style.display = bottom.style.display = 'block';
                        text2.style.display = text3.style.display = 'none';
                        this.style.backgroundColor=_this.btn[1].style.backgroundColor="rgb(168, 166, 245)";
                        _this.btn[0].style.backgroundColor=_this.a[1].style.backgroundColor="rgb(159, 231, 169)";
                        _this.btn[1].onoff = true;
                        _this.btn[0].onoff = false;
                        break
                        case 'replace':
                        text2.style.display = text3.style.display = 'block';
                        text1.style.display = 'none';
                        this.style.backgroundColor=_this.btn[0].style.backgroundColor="rgb(168, 166, 245)";
                        _this.btn[1].style.backgroundColor=_this.a[0].style.backgroundColor="rgb(159, 231, 169)";
                        _this.btn[0].onoff = true;
                        _this.btn[1].onoff = false;
                        break;
                        case 'close':
                        bottom.style.display = 'none';
                        break;
                    }
                }
            })
        }
    }
    new FindReplace()
</script>
</body>

</html>